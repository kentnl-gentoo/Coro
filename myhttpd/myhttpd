#!/usr/bin/perl

use Coro::Event;
use Time::HiRes 'time';

$starttime = time;

$VERSION = 0.09;

$SIG{CHLD} = 'IGNORE';

require "config.pl";
require "misc.pl";
require "database.pl";
require "netgeo.pl";
require "err.pl";
require "access.pl";
require "queue.pl";
require "tbf.pl";
require "diridx.pl";
require "internal.pl";
require "httpd.pl";
require "shell.pl";

loop;

if ($RESTART) {
   $_->close for @listen_sockets;
   fork && exec $0, @ARGV;
   loop(60*60);
}

print "myhttpd ended\n";#d#

